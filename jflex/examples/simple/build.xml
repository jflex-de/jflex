<project xmlns:ivy="antlib:org.apache.ivy.ant" name="simple scanner" default="build">

  <property name="jflex" value="../../target/jflex-full-1.7.1-SNAPSHOT.jar"/>
  <ivy:retrieve/>

  <taskdef classname="jflex.anttask.JFlexTask" name="jflex" classpath="${jflex}"/>

  <target name="run" depends="build">
    <java classname="Yylex" classpath="antbuild">
      <arg line="src/test/data/test.txt"/>
    </java>
  </target>

  <target name="test" depends="build">
    <junit>
      <test name="YylexTest">
        <formatter type="plain" usefile="false" />
      </test>
      <classpath refid="ivy-deps"/>
      <classpath refid="build-artifacts"/>
    </junit>
  </target>

  <target name="build" depends="scanner">
    <javac destdir="antbuild">
      <src path="src/main/java/" />
      <src path="src/test/java" />
      <src path="antbuild/"/>
      <classpath refid="ivy-deps"/>
    </javac>
  </target>

  <target name="scanner">
    <jflex file="src/main/jflex/simple.flex" destdir="antbuild"/>
  </target>

  <target name="clean">
    <delete dir="antbuild"/>
  </target>

  <path id="ivy-deps">
    <fileset dir="${ivy.lib.dir}">
      <include name="*.jar"/>
    </fileset>
  </path>

  <path id="build-artifacts">
    <pathelement path="antbuild"/>
  </path>
</project>
